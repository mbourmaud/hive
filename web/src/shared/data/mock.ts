import type { DroneInfo, ProjectInfo } from "@/domains/monitor/types";

export const MOCK_DRONES: DroneInfo[] = [
  {
    name: "auth-service",
    status: "in_progress",
    liveness: "working",
    branch: "feat/auth-service",
    worktree: "",
    lead_model: "claude-sonnet-4-5-20250929",
    started: "",
    updated: "",
    elapsed: "1h 2m",
    progress: [2, 5],
    cost: { total_usd: 1.24, input_tokens: 145234, output_tokens: 32456 },
    tasks: [
      {
        id: "1",
        subject: "Set up project structure and dependencies",
        description: "",
        status: "completed",
        owner: "worker-1",
        active_form: null,
        duration: "15m 00s",
        is_internal: false,
      },
      {
        id: "2",
        subject: "Add user model and database migrations",
        description: "",
        status: "completed",
        owner: "worker-2",
        active_form: null,
        duration: "18m 00s",
        is_internal: false,
      },
      {
        id: "3",
        subject: "Implement JWT token refresh endpoint",
        description: "",
        status: "in_progress",
        owner: "worker-1",
        active_form: "Implementing JWT refresh endpoint",
        duration: null,
        is_internal: false,
      },
      {
        id: "4",
        subject: "Add authentication middleware",
        description: "",
        status: "in_progress",
        owner: "worker-2",
        active_form: "Writing auth middleware",
        duration: null,
        is_internal: false,
      },
      {
        id: "5",
        subject: "Write integration tests for auth flow",
        description: "",
        status: "pending",
        owner: null,
        active_form: null,
        duration: null,
        is_internal: false,
      },
    ],
    members: [
      {
        name: "worker-1",
        agent_type: "",
        model: "claude-sonnet-4-5-20250929",
        liveness: "working",
      },
      {
        name: "worker-2",
        agent_type: "",
        model: "claude-sonnet-4-5-20250929",
        liveness: "working",
      },
      { name: "worker-3", agent_type: "", model: "claude-haiku-4-5-20251001", liveness: "idle" },
    ],
    messages: [
      {
        from: "team-lead",
        to: "worker-1",
        text: "Start with task 1 — set up the project structure. Use Express.js with TypeScript. Add jsonwebtoken, bcrypt, and prisma as dependencies.",
        timestamp: "2026-02-12T17:10:30Z",
      },
      {
        from: "team-lead",
        to: "worker-2",
        text: "Take task 2 — create the User model with Prisma. Include email, password hash, and role fields. Run the migration when done.",
        timestamp: "2026-02-12T17:11:00Z",
      },
      {
        from: "worker-1",
        to: "team-lead",
        text: "Project structure is set up. Express + TypeScript + Prisma all configured. Moving to the user model next.",
        timestamp: "2026-02-12T17:15:00Z",
      },
      {
        from: "worker-2",
        to: "team-lead",
        text: "User model and migrations done. Schema includes email, password_hash, role, created_at, updated_at. Ready for the next task.",
        timestamp: "2026-02-12T17:28:00Z",
      },
      {
        from: "team-lead",
        to: "worker-1",
        text: "Good work on the setup. Now take task 3 — implement the JWT refresh endpoint. Build on the user model worker-2 created.",
        timestamp: "2026-02-12T17:30:00Z",
      },
      {
        from: "worker-1",
        to: "team-lead",
        text: "Working on JWT refresh endpoint. Found an edge case with expired refresh tokens — adding a grace period of 30s. Will update when done.",
        timestamp: "2026-02-12T17:45:00Z",
      },
      {
        from: "worker-2",
        to: "team-lead",
        text: "Auth middleware is looking good. Validates access tokens, attaches user to req.context. Should I also handle API key auth or just JWT?",
        timestamp: "2026-02-12T17:52:00Z",
      },
      {
        from: "team-lead",
        to: "worker-2",
        text: "Nice. Move to task 4 — the auth middleware. Just JWT for now, we can add API key auth later.",
        timestamp: "2026-02-12T17:53:00Z",
      },
    ],
  },
  {
    name: "frontend-revamp",
    status: "completed",
    liveness: "completed",
    branch: "feat/frontend-revamp",
    worktree: "",
    lead_model: "claude-sonnet-4-5-20250929",
    started: "",
    updated: "",
    elapsed: "2h 15m",
    progress: [4, 4],
    cost: { total_usd: 3.87, input_tokens: 389000, output_tokens: 87000 },
    tasks: [
      {
        id: "1",
        subject: "Migrate to Tailwind v4",
        description: "",
        status: "completed",
        owner: "worker-1",
        active_form: null,
        duration: "25m 00s",
        is_internal: false,
      },
      {
        id: "2",
        subject: "Refactor component library to use composable patterns",
        description: "",
        status: "completed",
        owner: "worker-2",
        active_form: null,
        duration: "30m 00s",
        is_internal: false,
      },
      {
        id: "3",
        subject: "Add dark mode support",
        description: "",
        status: "completed",
        owner: "worker-1",
        active_form: null,
        duration: "20m 00s",
        is_internal: false,
      },
      {
        id: "4",
        subject: "Update E2E tests for new component APIs",
        description: "",
        status: "completed",
        owner: "worker-3",
        active_form: null,
        duration: "18m 00s",
        is_internal: false,
      },
    ],
    members: [
      {
        name: "worker-1",
        agent_type: "",
        model: "claude-sonnet-4-5-20250929",
        liveness: "completed",
      },
      {
        name: "worker-2",
        agent_type: "",
        model: "claude-sonnet-4-5-20250929",
        liveness: "completed",
      },
      {
        name: "worker-3",
        agent_type: "",
        model: "claude-haiku-4-5-20251001",
        liveness: "completed",
      },
    ],
    messages: [
      {
        from: "team-lead",
        to: "worker-1",
        text: "Start with Tailwind v4 migration. After that, pick up dark mode support — it depends on your Tailwind work.",
        timestamp: "2026-02-12T14:15:00Z",
      },
      {
        from: "worker-1",
        to: "team-lead",
        text: "Tailwind v4 migration complete. Replaced all deprecated utilities, updated config. All components render correctly.",
        timestamp: "2026-02-12T15:20:00Z",
      },
      {
        from: "worker-2",
        to: "team-lead",
        text: "Component refactoring done. Button, Card, Modal, Input all use compound patterns now. Breaking change: Card.Header replaces CardHeader.",
        timestamp: "2026-02-12T15:45:00Z",
      },
      {
        from: "worker-1",
        to: "team-lead",
        text: "Dark mode is live. Uses system preference by default with manual toggle. Preference persisted in localStorage.",
        timestamp: "2026-02-12T16:10:00Z",
      },
      {
        from: "worker-3",
        to: "team-lead",
        text: "All E2E tests updated and passing. 47 tests, 0 failures. PR is ready for review.",
        timestamp: "2026-02-12T16:30:00Z",
      },
    ],
  },
  {
    name: "db-migration",
    status: "stopped",
    liveness: "stopped",
    branch: "feat/db-migration",
    worktree: "",
    lead_model: "claude-sonnet-4-5-20250929",
    started: "",
    updated: "",
    elapsed: "1h 48m",
    progress: [1, 3],
    cost: { total_usd: 0.52, input_tokens: 54000, output_tokens: 12800 },
    tasks: [
      {
        id: "1",
        subject: "Create migration scripts for schema v2",
        description: "",
        status: "completed",
        owner: "worker-1",
        active_form: null,
        duration: "13m 00s",
        is_internal: false,
      },
      {
        id: "2",
        subject: "Migrate user sessions to Redis",
        description: "",
        status: "in_progress",
        owner: "worker-1",
        active_form: "Migrating session storage to Redis",
        duration: null,
        is_internal: false,
      },
      {
        id: "3",
        subject: "Add rollback procedures and verification",
        description: "",
        status: "pending",
        owner: null,
        active_form: null,
        duration: null,
        is_internal: false,
      },
    ],
    members: [
      {
        name: "worker-1",
        agent_type: "",
        model: "claude-sonnet-4-5-20250929",
        liveness: "stopped",
      },
      { name: "worker-2", agent_type: "", model: "claude-haiku-4-5-20251001", liveness: "stopped" },
    ],
    messages: [
      {
        from: "team-lead",
        to: "worker-1",
        text: "Start with the SQL migration scripts for schema v2. Once done, move to Redis session migration.",
        timestamp: "2026-02-12T16:12:00Z",
      },
      {
        from: "worker-1",
        to: "team-lead",
        text: "Migration scripts for schema v2 are done. Added columns, indexes, and constraints. Starting on the Redis session migration.",
        timestamp: "2026-02-12T16:25:00Z",
      },
      {
        from: "worker-1",
        to: "team-lead",
        text: "Hit an issue connecting to Redis. Connection pooling config seems wrong. Getting ECONNREFUSED on port 6379.",
        timestamp: "2026-02-12T16:48:00Z",
      },
      {
        from: "team-lead",
        to: "worker-1",
        text: "Check if Redis is running locally. Try docker compose up redis if it's containerized.",
        timestamp: "2026-02-12T16:50:00Z",
      },
    ],
  },
];

export const MOCK_PROJECTS: ProjectInfo[] = (() => {
  const drone0 = MOCK_DRONES[0];
  const drone1 = MOCK_DRONES[1];
  const drone2 = MOCK_DRONES[2];
  if (!drone0 || !drone1 || !drone2) return [];
  return [
    {
      name: "my-api",
      path: "/Users/dev/projects/my-api",
      drones: [drone0, drone2],
      total_cost: drone0.cost.total_usd + drone2.cost.total_usd,
      active_count: 1,
    },
    {
      name: "my-frontend",
      path: "/Users/dev/projects/my-frontend",
      drones: [drone1],
      total_cost: drone1.cost.total_usd,
      active_count: 0,
    },
  ];
})();

export const MOCK_LOGS: Record<string, string[]> = {
  "auth-service": [
    "[worker-1] Read package.json",
    "[worker-1] Bash: npm init -y && npm install express typescript jsonwebtoken bcrypt @prisma/client",
    "[worker-1] Write src/index.ts — Express server setup",
    "[worker-1] Write tsconfig.json",
    "[worker-2] Read prisma/schema.prisma",
    "[worker-2] Edit prisma/schema.prisma — added User model with email, password_hash, role",
    "[worker-2] Bash: npx prisma migrate dev --name add-users",
    "[worker-2] Migration applied successfully",
    "[worker-1] Read src/models/user.ts",
    "[worker-1] Write src/routes/auth.ts — POST /auth/refresh endpoint",
    "[worker-1] Handling edge case: expired refresh tokens with 30s grace period",
    "[worker-2] Write src/middleware/auth.ts — JWT validation middleware",
    "[worker-2] Read src/routes/index.ts",
    "[worker-2] Edit src/routes/index.ts — applying auth middleware to protected routes",
  ],
  "frontend-revamp": [
    "[worker-1] Read tailwind.config.js",
    "[worker-1] Bash: npm install tailwindcss@4.0.0",
    "[worker-1] Edit tailwind.config.js — migrating to v4 syntax",
    '[worker-1] Grep "bg-opacity" across 24 files — replacing deprecated utilities',
    "[worker-2] Read src/components/Button.tsx",
    "[worker-2] Write src/components/Button/index.tsx — compound component pattern",
    "[worker-2] Write src/components/Card/index.tsx — compound component pattern",
    "[worker-1] Write src/hooks/useTheme.ts — system-aware dark mode",
    "[worker-1] Edit src/pages/Settings.tsx — added theme toggle",
    "[worker-3] Read tests/e2e/components.spec.ts",
    "[worker-3] Edit tests/e2e/components.spec.ts — updated for new compound APIs",
    "[worker-3] Bash: npx playwright test — 47 passed, 0 failed",
  ],
  "db-migration": [
    "[worker-1] Read migrations/001_initial.sql",
    "[worker-1] Write migrations/002_schema_v2.sql — new columns and indexes",
    "[worker-1] Bash: psql -f migrations/002_schema_v2.sql",
    "[worker-1] Migration applied successfully",
    "[worker-1] Read src/session/store.ts",
    "[worker-1] Bash: redis-cli ping",
    "[worker-1] ERROR: Could not connect to Redis at 127.0.0.1:6379: Connection refused",
    "[worker-1] Retrying connection...",
    "[worker-1] ERROR: ECONNREFUSED — Redis not reachable",
  ],
};
