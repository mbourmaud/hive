// Exempt from 300-line rule: pure fixture data
import type { DroneInfo, ProjectInfo } from "@/domains/monitor/types";

export const MOCK_DRONES: DroneInfo[] = [
  {
    name: "auth-service",
    title: "Authentication Service",
    description:
      "Add JWT-based auth with refresh tokens, role-based access control, and session management.",
    status: "in_progress",
    liveness: "working",
    branch: "feat/auth-service",
    worktree: "",
    lead_model: "claude-sonnet-4-5-20250929",
    phase: null,
    started: "",
    updated: "",
    elapsed: "1h 2m",
    progress: [2, 5],
    cost: { cache_creation_tokens: 0, cache_read_tokens: 0, total_usd: 1.24, input_tokens: 145234, output_tokens: 32456 },
    tasks: [
      {
        id: "1",
        subject: "US-001: Set up project structure and dependencies",
        description: "",
        status: "completed",
        owner: "project-deps",
        active_form: null,
        duration: "15m 00s",
        is_internal: false,
        retry_count: 0,
        blocked_by: null,
      },
      {
        id: "2",
        subject: "US-002: Add user model and database migrations",
        description: "",
        status: "completed",
        owner: "user-model",
        active_form: null,
        duration: "18m 00s",
        is_internal: false,
        retry_count: 0,
        blocked_by: null,
      },
      {
        id: "3",
        subject: "US-003: Implement JWT token refresh endpoint",
        description: "",
        status: "in_progress",
        owner: "jwt-refresh",
        active_form: "Implementing JWT refresh endpoint",
        duration: null,
        is_internal: false,
        retry_count: 0,
        blocked_by: null,
      },
      {
        id: "4",
        subject: "US-004: Add authentication middleware",
        description: "",
        status: "in_progress",
        owner: "auth-middleware",
        active_form: "Writing auth middleware",
        duration: null,
        is_internal: false,
        retry_count: 0,
        blocked_by: null,
      },
      {
        id: "5",
        subject: "US-005: Write integration tests for auth flow",
        description: "",
        status: "pending",
        owner: null,
        active_form: null,
        duration: null,
        is_internal: false,
        retry_count: 0,
        blocked_by: null,
      },
    ],
    members: [
      {
        name: "project-deps",
        agent_type: "",
        model: "claude-sonnet-4-5-20250929",
        liveness: "completed",
        current_task_id: null,
      },
      {
        name: "user-model",
        agent_type: "",
        model: "claude-sonnet-4-5-20250929",
        liveness: "completed",
        current_task_id: null,
      },
      {
        name: "jwt-refresh",
        agent_type: "",
        model: "claude-sonnet-4-5-20250929",
        liveness: "working",
        current_task_id: null,
      },
      {
        name: "auth-middleware",
        agent_type: "",
        model: "claude-sonnet-4-5-20250929",
        liveness: "working",
        current_task_id: null,
      },
      {
        name: "integration-tests",
        agent_type: "",
        model: "claude-haiku-4-5-20251001",
        liveness: "idle",
        current_task_id: null,
      },
    ],
    messages: [
      {
        from: "team-lead",
        to: "project-deps",
        text: "Start with task 1 — set up the project structure. Use Express.js with TypeScript. Add jsonwebtoken, bcrypt, and prisma as dependencies.",
        timestamp: "2026-02-12T17:10:30Z",
      },
      {
        from: "team-lead",
        to: "user-model",
        text: "Take task 2 — create the User model with Prisma. Include email, password hash, and role fields. Run the migration when done.",
        timestamp: "2026-02-12T17:11:00Z",
      },
      {
        from: "project-deps",
        to: "team-lead",
        text: "Project structure is set up. Express + TypeScript + Prisma all configured. Moving to the user model next.",
        timestamp: "2026-02-12T17:15:00Z",
      },
      {
        from: "user-model",
        to: "team-lead",
        text: "User model and migrations done. Schema includes email, password_hash, role, created_at, updated_at. Ready for the next task.",
        timestamp: "2026-02-12T17:28:00Z",
      },
      {
        from: "team-lead",
        to: "jwt-refresh",
        text: "Good work on the setup. Now take task 3 — implement the JWT refresh endpoint. Build on the user model.",
        timestamp: "2026-02-12T17:30:00Z",
      },
      {
        from: "jwt-refresh",
        to: "team-lead",
        text: "Working on JWT refresh endpoint. Found an edge case with expired refresh tokens — adding a grace period of 30s. Will update when done.",
        timestamp: "2026-02-12T17:45:00Z",
      },
      {
        from: "auth-middleware",
        to: "team-lead",
        text: "Auth middleware is looking good. Validates access tokens, attaches user to req.context. Should I also handle API key auth or just JWT?",
        timestamp: "2026-02-12T17:52:00Z",
      },
      {
        from: "team-lead",
        to: "auth-middleware",
        text: "Nice. Just JWT for now, we can add API key auth later.",
        timestamp: "2026-02-12T17:53:00Z",
      },
    ],
  },
  {
    name: "frontend-revamp",
    title: "Frontend UI Revamp",
    description:
      "Redesign the dashboard with new component library, dark mode support, and responsive layouts.",
    status: "completed",
    liveness: "completed",
    branch: "feat/frontend-revamp",
    worktree: "",
    lead_model: "claude-sonnet-4-5-20250929",
    phase: null,
    started: "",
    updated: "",
    elapsed: "2h 15m",
    progress: [4, 4],
    cost: { cache_creation_tokens: 0, cache_read_tokens: 0, total_usd: 3.87, input_tokens: 389000, output_tokens: 87000 },
    tasks: [
      {
        id: "1",
        subject: "US-001: Migrate to Tailwind v4",
        description: "",
        status: "completed",
        owner: "tailwind-v4",
        active_form: null,
        duration: "25m 00s",
        is_internal: false,
        retry_count: 0,
        blocked_by: null,
      },
      {
        id: "2",
        subject: "US-002: Refactor component library to use composable patterns",
        description: "",
        status: "completed",
        owner: "component-lib",
        active_form: null,
        duration: "30m 00s",
        is_internal: false,
        retry_count: 0,
        blocked_by: null,
      },
      {
        id: "3",
        subject: "US-003: Add dark mode support",
        description: "",
        status: "completed",
        owner: "dark-mode",
        active_form: null,
        duration: "20m 00s",
        is_internal: false,
        retry_count: 0,
        blocked_by: null,
      },
      {
        id: "4",
        subject: "US-004: Update E2E tests for new component APIs",
        description: "",
        status: "completed",
        owner: "e2e-tests",
        active_form: null,
        duration: "18m 00s",
        is_internal: false,
        retry_count: 0,
        blocked_by: null,
      },
    ],
    members: [
      {
        name: "tailwind-v4",
        agent_type: "",
        model: "claude-sonnet-4-5-20250929",
        liveness: "completed",
        current_task_id: null,
      },
      {
        name: "component-lib",
        agent_type: "",
        model: "claude-sonnet-4-5-20250929",
        liveness: "completed",
        current_task_id: null,
      },
      {
        name: "dark-mode",
        agent_type: "",
        model: "claude-sonnet-4-5-20250929",
        liveness: "completed",
        current_task_id: null,
      },
      {
        name: "e2e-tests",
        agent_type: "",
        model: "claude-haiku-4-5-20251001",
        liveness: "completed",
        current_task_id: null,
      },
    ],
    messages: [
      {
        from: "team-lead",
        to: "tailwind-v4",
        text: "Start with Tailwind v4 migration. After that, pick up dark mode support — it depends on your Tailwind work.",
        timestamp: "2026-02-12T14:15:00Z",
      },
      {
        from: "tailwind-v4",
        to: "team-lead",
        text: "Tailwind v4 migration complete. Replaced all deprecated utilities, updated config. All components render correctly.",
        timestamp: "2026-02-12T15:20:00Z",
      },
      {
        from: "component-lib",
        to: "team-lead",
        text: "Component refactoring done. Button, Card, Modal, Input all use compound patterns now. Breaking change: Card.Header replaces CardHeader.",
        timestamp: "2026-02-12T15:45:00Z",
      },
      {
        from: "dark-mode",
        to: "team-lead",
        text: "Dark mode is live. Uses system preference by default with manual toggle. Preference persisted in localStorage.",
        timestamp: "2026-02-12T16:10:00Z",
      },
      {
        from: "e2e-tests",
        to: "team-lead",
        text: "All E2E tests updated and passing. 47 tests, 0 failures. PR is ready for review.",
        timestamp: "2026-02-12T16:30:00Z",
      },
    ],
  },
  {
    name: "db-migration",
    title: "Database Migration v3",
    description:
      "Migrate from PostgreSQL 14 to 16 with zero-downtime schema changes and data backfill.",
    status: "stopped",
    liveness: "stopped",
    branch: "feat/db-migration",
    worktree: "",
    lead_model: "claude-sonnet-4-5-20250929",
    phase: null,
    started: "",
    updated: "",
    elapsed: "1h 48m",
    progress: [1, 3],
    cost: { cache_creation_tokens: 0, cache_read_tokens: 0, total_usd: 0.52, input_tokens: 54000, output_tokens: 12800 },
    tasks: [
      {
        id: "1",
        subject: "US-001: Create migration scripts for schema v2",
        description: "",
        status: "completed",
        owner: "migration-scripts",
        active_form: null,
        duration: "13m 00s",
        is_internal: false,
        retry_count: 0,
        blocked_by: null,
      },
      {
        id: "2",
        subject: "US-002: Migrate user sessions to Redis",
        description: "",
        status: "in_progress",
        owner: "redis-sessions",
        active_form: "Migrating session storage to Redis",
        duration: null,
        is_internal: false,
        retry_count: 0,
        blocked_by: null,
      },
      {
        id: "3",
        subject: "US-003: Add rollback procedures and verification",
        description: "",
        status: "pending",
        owner: null,
        active_form: null,
        duration: null,
        is_internal: false,
        retry_count: 0,
        blocked_by: null,
      },
    ],
    members: [
      {
        name: "migration-scripts",
        agent_type: "",
        model: "claude-sonnet-4-5-20250929",
        liveness: "stopped",
        current_task_id: null,
      },
      {
        name: "redis-sessions",
        agent_type: "",
        model: "claude-sonnet-4-5-20250929",
        liveness: "stopped",
        current_task_id: null,
      },
      {
        name: "rollback-verify",
        agent_type: "",
        model: "claude-haiku-4-5-20251001",
        liveness: "stopped",
        current_task_id: null,
      },
    ],
    messages: [
      {
        from: "team-lead",
        to: "migration-scripts",
        text: "Start with the SQL migration scripts for schema v2. Once done, move to Redis session migration.",
        timestamp: "2026-02-12T16:12:00Z",
      },
      {
        from: "migration-scripts",
        to: "team-lead",
        text: "Migration scripts for schema v2 are done. Added columns, indexes, and constraints. Starting on the Redis session migration.",
        timestamp: "2026-02-12T16:25:00Z",
      },
      {
        from: "redis-sessions",
        to: "team-lead",
        text: "Hit an issue connecting to Redis. Connection pooling config seems wrong. Getting ECONNREFUSED on port 6379.",
        timestamp: "2026-02-12T16:48:00Z",
      },
      {
        from: "team-lead",
        to: "redis-sessions",
        text: "Check if Redis is running locally. Try docker compose up redis if it's containerized.",
        timestamp: "2026-02-12T16:50:00Z",
      },
    ],
  },
];

export const MOCK_PROJECTS: ProjectInfo[] = (() => {
  const drone0 = MOCK_DRONES[0];
  const drone1 = MOCK_DRONES[1];
  const drone2 = MOCK_DRONES[2];
  if (!drone0 || !drone1 || !drone2) return [];
  return [
    {
      name: "my-api",
      path: "/Users/dev/projects/my-api",
      drones: [drone0, drone2],
      total_cost: drone0.cost.total_usd + drone2.cost.total_usd,
      active_count: 1,
    },
    {
      name: "my-frontend",
      path: "/Users/dev/projects/my-frontend",
      drones: [drone1],
      total_cost: drone1.cost.total_usd,
      active_count: 0,
    },
  ];
})();

export const MOCK_LOGS: Record<string, string[]> = {
  "auth-service": [
    "[project-deps] Read package.json",
    "[project-deps] Bash: npm init -y && npm install express typescript jsonwebtoken bcrypt @prisma/client",
    "[project-deps] Write src/index.ts — Express server setup",
    "[project-deps] Write tsconfig.json",
    "[user-model] Read prisma/schema.prisma",
    "[user-model] Edit prisma/schema.prisma — added User model with email, password_hash, role",
    "[user-model] Bash: npx prisma migrate dev --name add-users",
    "[user-model] Migration applied successfully",
    "[jwt-refresh] Read src/models/user.ts",
    "[jwt-refresh] Write src/routes/auth.ts — POST /auth/refresh endpoint",
    "[jwt-refresh] Handling edge case: expired refresh tokens with 30s grace period",
    "[auth-middleware] Write src/middleware/auth.ts — JWT validation middleware",
    "[auth-middleware] Read src/routes/index.ts",
    "[auth-middleware] Edit src/routes/index.ts — applying auth middleware to protected routes",
  ],
  "frontend-revamp": [
    "[tailwind-v4] Read tailwind.config.js",
    "[tailwind-v4] Bash: npm install tailwindcss@4.0.0",
    "[tailwind-v4] Edit tailwind.config.js — migrating to v4 syntax",
    '[tailwind-v4] Grep "bg-opacity" across 24 files — replacing deprecated utilities',
    "[component-lib] Read src/components/Button.tsx",
    "[component-lib] Write src/components/Button/index.tsx — compound component pattern",
    "[component-lib] Write src/components/Card/index.tsx — compound component pattern",
    "[dark-mode] Write src/hooks/useTheme.ts — system-aware dark mode",
    "[dark-mode] Edit src/pages/Settings.tsx — added theme toggle",
    "[e2e-tests] Read tests/e2e/components.spec.ts",
    "[e2e-tests] Edit tests/e2e/components.spec.ts — updated for new compound APIs",
    "[e2e-tests] Bash: npx playwright test — 47 passed, 0 failed",
  ],
  "db-migration": [
    "[migration-scripts] Read migrations/001_initial.sql",
    "[migration-scripts] Write migrations/002_schema_v2.sql — new columns and indexes",
    "[migration-scripts] Bash: psql -f migrations/002_schema_v2.sql",
    "[migration-scripts] Migration applied successfully",
    "[redis-sessions] Read src/session/store.ts",
    "[redis-sessions] Bash: redis-cli ping",
    "[redis-sessions] ERROR: Could not connect to Redis at 127.0.0.1:6379: Connection refused",
    "[redis-sessions] Retrying connection...",
    "[redis-sessions] ERROR: ECONNREFUSED — Redis not reachable",
  ],
};
